import numpy as n

N = [8,16,32,64,128,256,512,1024,2048,4096,8192,16384,32768,65536,131072,262144,524288,1048576,2097152,4194304,8388608,16777216]
inter = [0.000001354,0.000001302,0.000001273,0.000001276,0.000001316,0.000001323,0.000001431,0.000001645,0.000002074,0.000002842,
        0.000004706,0.000005679,0.000007749,0.000011454,0.000019240,0.000034914,0.000065758,0.000126987,0.000254204,0.000466502,
        0.000997903,0.001978073]
intra = [0.000000575,0.000000606,0.000000668,0.000000746,0.000000916,0.000000772,0.000000901,0.000001359,0.000001180,0.000001729,
        0.000003679,0.000004139,0.000006690,0.000011556,0.000023944,0.000045180,0.000086980,0.000172107,0.000342450,0.000682654,
        0.001364646,0.002719507]

# N = [8,16,32,64,128,256,512,1024,2048,4096,8192,16384,32768,65536,131072,262144,524288,1048576,2097152,4194304,8388608,16777216,33554432,67108864,134217728,268435456,536870912,1073741824]
# inter = [0.000001354,0.000001302,0.000001273,0.000001276,0.000001316,0.000001323,0.000001431,0.000001645,0.000002074,0.000002842,
#         0.000004706,0.000005679,0.000007749,0.000011454,0.000019240,0.000034914,0.000065758,0.000126987,0.000254204,0.000466502,
#         0.000997903,0.001978073,0.003792682,0.008617511,0.017515094,0.034691787,0.070977032,0.1414]
# intra = [0.000000575,0.000000606,0.000000668,0.000000746,0.000000916,0.000000772,0.000000901,0.000001359,0.000001180,0.000001729,
#         0.000003679,0.000004139,0.000006690,0.000011556,0.000023944,0.000045180,0.000086980,0.000172107,0.000342450,0.000682654,
#         0.001364646,0.002719507,0.005528224,0.011307344,0.022855937,0.045983405,0.092266812,0.184605513]

band_intra,lat_intra = n.polyfit(N,intra,1)
band_inter,lat_inter = n.polyfit(N,inter,1)

print(f"Intra \nlatency: {lat_intra/1e-6} s\nBandwith: {1/band_intra/1e9} GB/s")
print(f"Inter \nlatency: {lat_inter/1e-6} s\nBandwith: {1/band_inter/1e9} GB/s")

'''
Inter

        N           Time(s)

         8          0.000001354
        16          0.000001302
        32          0.000001273
        64          0.000001276
       128          0.000001316
       256          0.000001323
       512          0.000001431
      1024          0.000001645
      2048          0.000002074
      4096          0.000002842
      8192          0.000004706
     16384          0.000005679
     32768          0.000007749
     65536          0.000011454
    131072          0.000019240
    262144          0.000034914
    524288          0.000065758
   1048576          0.000126987
   2097152          0.000254204
   4194304          0.000466502
   8388608          0.000997903
  16777216          0.001978073
  33554432          0.003792682
  67108864          0.008617511
 134217728          0.017515094
 268435456          0.034691787
 536870912          0.070977032
1073741824          0.1414

Intra:
         8          0.000000575
        16          0.000000606
        32          0.000000668
        64          0.000000746
       128          0.000000916
       256          0.000000772
       512          0.000000901
      1024          0.000001359
      2048          0.000001180
      4096          0.000001729
      8192          0.000003679
     16384          0.000004139
     32768          0.000006690
     65536          0.000011556
    131072          0.000023944
    262144          0.000045180
    524288          0.000086980
   1048576          0.000172107
   2097152          0.000342450
   4194304          0.000682654
   8388608          0.001364646
  16777216          0.002719507
  33554432          0.005528224
  67108864          0.011307344
 134217728          0.022855937
 268435456          0.045983405
 536870912          0.092266812
1073741824          0.184605513
'''